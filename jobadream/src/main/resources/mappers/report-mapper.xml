<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="reportMapper">
	<!-- Pagination ResultMap -->
	<resultMap type="ReportPagination" id="rpg_rm">
		<result property="listCount" column="CNT" />
	</resultMap>

	<!-- join용 -->
	<resultMap type="Member" id="member_rm">
		<id property="memberNo" column="MEMBER_NO" />
		<result property="memberId" column="MEMBER_ID" />
		<result property="memberPw" column="MEMBER_PW" />
		<result property="memberName" column="MEMBER_NM" />
		<result property="memberPhone" column="MEMBER_PHONE" />
		<result property="memberEmail" column="MEMBER_EMAIL" />
		<result property="memberAddress" column="MEMBER_ADDR" />
		<result property="enrollDate" column="ENROLL_DATE" />
		<result property="memberStatus" column="MEMBER_STATUS" />
		<result property="memberGrade" column="MEMBER_GRADE" />
		<result property="memberPoint" column="MEMBER_POINT" />
		<result property="memberIntroduce" column="MEMBER_INTRODUCE" />
	</resultMap>

	<!-- Report 목록조회, 상세조회용 ResultMap -->
	<resultMap type="Report" id="re_rm">
		<id property="reportNo" column="REPORT_NO" />
		<result property="reportTitle" column="REPORT_TITLE" />
		<result property="reportContent" column="REPORT_CONTENT" />
		<result property="reportDt" column="REPORT_DT" />
		<result property="reportStatus" column="REPORT_STATUS" />
		<result property="reportReplyStatus"
			column="REPORT_REPLY_STATUS" />
		<result property="reportAttachment" column="REPORT_ATTACHMENT" />
		<result property="memberNo" column="MEMBER_NO" />
		<result property="reportCategoryCd" column="REPORT_CATEGORY_CD" />
		<collection property="mem" resultMap="member_rm" />
		<collection property="rcategory" resultMap="rcate_rm" />
	</resultMap>
	
	<resultMap type="ReportCategory" id="rcate_rm">
		<id property="reportCategoryCd" column="REPORT_CATEGORY_CD" />
		<result property="reportCategoryTitle" column="REPORT_CATEGORY_TITLE" />
	</resultMap>

	<!-- 전체게시글수 조회 -->
	<select id="getListCount" resultMap="rpg_rm">
		SELECT COUNT(*) CNT
		FROM REPORT
		WHERE REPORT_STATUS = 'Y'
	</select>
	
	<!-- 전체게시글 목록조회 -->
	<select id="selectReportList"
		parameterType="ReportPagination" resultMap="re_rm">
		SELECT REPORT_NO, REPORT_TITLE, REPORT_CONTENT, REPORT_DT,
		REPORT_STATUS,MEMBER_NO, MEMBER_ID,REPORT_CATEGORY_CD,REPORT_CATEGORY_TITLE
		FROM REPORT
		JOIN MEMBER USING(MEMBER_NO)
		JOIN REPORT_CATEGORY USING(REPORT_CATEGORY_CD)
		ORDER BY REPORT_NO DESC
	</select>
	
	
	
</mapper>
